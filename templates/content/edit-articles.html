{% extends "main.html" %}
{% block title %}Anodos: Статьи{% endblock %}
{% block content %}
{% if perms.project.change_article %}


<!-- Панель кнопок -->
<div class="row collapse">
	<ul class="button-group even-2">
		<li><button data-do="open-new-article" class="secondary"><i class="fa fa-pencil"></i> Написать статью</button></li>
		<li><button data-do="open-new-document" class="secondary"><i class="fa fa-upload"></i> Загрузить файл</button></li>
	</ul>
</div>


<!-- Таблица со списком статей -->
<div class="row collapse">
	<table>
		<tr>
			<th class="text-center">#</th>
			<th>Заголовок</th>
			<th>Статус</th>
			<th>Автор</th>
			<th>Дата создания</th>
		</tr>
		{% for article in articles %}
		<tr>
			<td>{{ forloop.counter }}</td>
			<td><a id="article-{{ article.id }}" data-do="open-edit-article" data-id="{{ article.id }}">{{ article.title }}</a></td>
			<td>
				<div class="switch small">
					<input id="article-state-{{ article.id }}" data-id="{{ article.id }}" data-do="switch-article-state" type="checkbox"{% if article.state %} checked{% endif %}>
					<label for="article-state-{{ article.id }}"></label>
				</div>
			</td>
			<td>{{ article.created_by }}</td>
			<td>{{ article.created|date:"d.m.Y H.i" }}</td>
		</tr>
		{% endfor %}
	</table>
</div>


<!-- Модальное окно добавления статьи -->
<div id="modal-edit-article" class="reveal-modal large" data-reveal>
	<dl class="tabs" data-tab>
		<dd id="modal-edit-article-content-dd" class="active"><a href="#modal-edit-article-content">Содержание</a></dd>
		<dd id="modal-edit-article-desc-dd"><a href="#modal-edit-article-desc">Описание</a></dd>
		<dd id="modal-edit-article-meta-dd"><a href="#modal-edit-article-meta">Служебное</a></dd>
	</dl>
	<div class="tabs-content">
		<div id="modal-edit-article-content" class="content active">

			<input id="edit-article-id" type="hidden" value="0">

			<label>Заголовок
				<input id="edit-article-title" type="text" value="">
			</label>

			<label>Содержание
				<textarea id="edit-article-content"></textarea>
			</label>

		</div>
		<div id="modal-edit-article-desc" class="content">

			<label>Псевдоним
				<input id="edit-article-alias" type="text" value="">
			</label>

			<label>Путь
				<input id="edit-article-patch" type="text" value="">
			</label>

			<label>Предпросмотр
				<input id="edit-article-thumb_src" type="text" value="">
			</label>

			<label>Вступительный текст
				<textarea id="edit-article-intro"></textarea>
			</label>

			<label>Описание
				<textarea id="edit-article-description"></textarea>
			</label>

			<label>Категория
				<select id="edit-article-category">
					<option value="0" selected> - Не определена - </option>
					{% for category in categories %}
					<option value="{{ category.id }}">{{ category.name }}</option>
					{% endfor %}
				</select>
			</label>

			<label>Язык
				<select id="edit-article-language">
					<option value="0" selected> - Не определён - </option>
					{% for language in languages %}
					<option value="{{ language.id }}">{{ language.name }}</option>
					{% endfor %}
				</select>
			</label>

			<label>Источник
				<input id="edit-article-source" type="text" value="">
			</lable>

			<lable>Ссылка на источник
				<input id="edit-article-source_url" type="text" value="">
			</lable>

		</div>
		<div id="modal-edit-article-meta" class="content">

			<label>Статус
				<div class="switch small">
					<input id="edit-article-state" type="checkbox">
					<label for="edit-article-state"></label>
				</div>
			</label>

			<label>На главной
				<div class="switch small">
					<input id="edit-article-on_main" type="checkbox">
					<label for="edit-article-on_main"></label>
				</div>
			</label>

		</div>
	</div>

	<button data-do="edit-article-save" class="primary"><i class="fa fa-ok"></i>&nbsp;Сохранить</button>
	<button data-do="edit-article-cancel" class="secondary">Отмена</button>
	<a class="close-reveal-modal">&#215;</a>
</div>


<!-- Модальное окно добавления файла -->
<div id="modal-add-document" class="reveal-modal large" data-reveal>
	<h2>Загрузить файл</h2>
	<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
	<input type="hidden" name="id" value="0">
	<textarea name=""></textarea>
	<button class="alert"><i class="fa fa-ok"></i>&nbsp;Выйти</button>
	<button data-do="profile-modal-cancel" class="secondary">Отмена</button>
	<a class="close-reveal-modal">&#215;</a>
</div>


<!-- Модальное окно удаления статьи -->
<div id="modal-trash-article" class="reveal-modal large" data-reveal>
	<h2>Удалить статью?</h2>
	<!-- TODO Заголовок, автор, дата -->
	<input id="trash-article-id" type="hidden" value="0">
	<button data-do="trash-article" class="alert"><i class="fa fa-trash"></i>&nbsp;Удалить</button>
	<button data-do="profile-modal-cancel" class="secondary">Отмена</button>
	<a class="close-reveal-modal">&#215;</a>
</div>



{% else %}
<div class="row collapse">
	<div class="small-12 columns">
		<p class="panel">Недостаточно прав для данной функциональности.</p>
	</div>
</div>
{% endif %}
{% endblock %}


{% block js-content %}
<script>
{% include "content/js/articles.js" %}
</script>
{% endblock %}
